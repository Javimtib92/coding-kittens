---
import RootLayout from '../../layouts/RootLayout.astro';
import ArticleItem from '../../components/ArticleItem.astro';
import CategoriesList from '../../components/CategoriesList.astro';
import { getCollection } from 'astro:content';
import logo from '../../assets/logo.png';

const posts = (
  await getCollection('blog', ({ data }) => {
    return import.meta.env.PROD ? data.draft !== true : true;
  })
).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<RootLayout
  title={'Blog | Javier MuÃ±oz Tous'}
  shortDescription={'Explore a diverse range of topics, including technology, development, and personal insights on my blog.'}
  image={logo.src}
>
  <CategoriesList />
  <div class='mx-auto my-0 flex max-w-7xl flex-wrap justify-between pb-0'>
    <main class='flex-1 pb-14 lg:flex-[0_0_770px]'>
      <div class='divide-y divide-gray-200 dark:divide-gray-700'>
        {
          posts.map(async (post) => {
            const { remarkPluginFrontmatter } = await post.render();
            return (
              <ArticleItem
                slug={post.slug}
                readingTime={remarkPluginFrontmatter.readingTime}
                {...post.data}
              />
            );
          })
        }
      </div>
    </main>
  </div>
</RootLayout>
